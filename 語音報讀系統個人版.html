<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªéŸ³å ±è®€ç³»çµ±é€£çµ QR Code ç”¢ç”Ÿå™¨</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                    },
                    colors: {
                        sheets: {
                            green: '#0f9d58',
                            header: '#f3f3f3',
                            border: '#e0e0e0',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
            /* å‚™ç”¨èƒŒæ™¯ï¼šè‹¥æ¼¸å±¤ä¸æ”¯æ´ */
            background-attachment: fixed;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }

        .input-group:focus-within label {
            color: #4f46e5;
        }

        .input-group:focus-within svg {
            color: #4f46e5;
        }

        /* æ¨¡æ“¬ Google Sheets æ¨£å¼ */
        .sheet-container {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .sheet-table th {
            background-color: #f3f3f3;
            color: #444;
            font-weight: 600;
            text-align: center;
            border: 1px solid #e0e0e0;
            padding: 8px;
            font-size: 0.85rem;
        }
        .sheet-table td {
            border: 1px solid #e0e0e0;
            padding: 8px 12px;
            font-size: 0.9rem;
            background: white;
        }
        .sheet-row-header {
            background-color: #f3f3f3 !important;
            color: #666;
            width: 40px;
            text-align: center;
            font-weight: 600;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen py-10 px-4 text-gray-700">

    <div class="container mx-auto max-w-3xl">
        
        <!-- Header -->
        <header class="text-center mb-10">
            <div class="inline-block p-3 rounded-full bg-white shadow-md mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z" />
                </svg>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 tracking-tight mb-3">èªéŸ³å ±è®€ç³»çµ±é€£çµç”¢ç”Ÿå™¨</h1>
            <div class="flex flex-col gap-1 items-center justify-center text-gray-600">
                <p class="text-base">è¼¸å…¥ Google Drive é€£çµï¼Œå¿«é€Ÿç”Ÿæˆ QR Code</p>
                <p class="text-sm text-indigo-600 bg-indigo-50 px-3 py-1 rounded-full font-medium inline-block">
                    âœ¨ æ”¯æ´ Google è©¦ç®—è¡¨ç™¼éŸ³ç³¾æ­£åŠŸèƒ½
                </p>
            </div>
        </header>

        <!-- Main Content Grid -->
        <div class="grid gap-8">
            
            <!-- Instructions Card -->
            <div class="glass-card rounded-2xl p-6 md:p-8">
                <div class="flex items-center gap-2 mb-4 text-emerald-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <h2 class="text-lg font-bold">ä½¿ç”¨å‰å¿…è®€</h2>
                </div>

                <div class="space-y-6">
                    <!-- Rule 1 -->
                    <div class="flex gap-3">
                        <span class="flex-shrink-0 w-6 h-6 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center font-bold text-sm">1</span>
                        <div>
                            <p class="font-bold text-gray-800">å…±ç”¨æ¬Šé™è¨­å®š</p>
                            <p class="text-sm text-gray-600 mt-1">è©¦ç®—è¡¨èˆ‡ <span class="text-indigo-600 font-medium">å ±è®€ç”¨çš„ PDF æª”</span> çš†å¿…é ˆè¨­å®šç‚ºã€Œ<strong>çŸ¥é“é€£çµçš„ä»»ä½•äººçš†å¯æŸ¥çœ‹</strong>ã€ã€‚</p>
                            <p class="text-xs text-gray-500 mt-2 bg-gray-50 p-2 rounded border border-gray-100">
                                ğŸ’¡ å»ºè­°å°‡ PDF æª”èˆ‡è©¦ç®—è¡¨å­˜æ”¾åœ¨åŒä¸€å€‹ Google Drive è³‡æ–™å¤¾ä¸­ï¼Œä¾¿æ–¼ç®¡ç†ã€‚å¤šå€‹ PDF å¯å…±ç”¨åŒä¸€ä»½è©¦ç®—è¡¨ã€‚
                            </p>
                        </div>
                    </div>

                    <!-- Rule 2 -->
                    <div class="flex gap-3">
                        <span class="flex-shrink-0 w-6 h-6 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center font-bold text-sm">2</span>
                        <div class="w-full">
                            <p class="font-bold text-gray-800 mb-2">è©¦ç®—è¡¨æ ¼å¼è¦ç¯„ (ç ´éŸ³å­—æ ¡æ­£)</p>
                            
                            <!-- Visual Spreadsheet -->
                            <div class="sheet-container mb-2">
                                <div class="bg-sheets-green text-white px-3 py-1 text-xs font-bold flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/><path d="M7 12h2v5H7zm4-7h2v12h-2zm4 4h2v8h-2z"/></svg>
                                    æ ¡æ­£ç™¼éŸ³è¡¨
                                </div>
                                <table class="sheet-table w-full border-collapse">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>A</th>
                                            <th>B</th>
                                            <th>C</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="sheet-row-header">1</td>
                                            <td class="text-gray-400 text-center text-xs">åºè™Ÿ (æ¨™é¡Œ)</td>
                                            <td class="text-gray-400 text-center text-xs">åŸå§‹èªè© (æ¨™é¡Œ)</td>
                                            <td class="text-gray-400 text-center text-xs">æ›¿æ›èªè© (æ¨™é¡Œ)</td>
                                        </tr>
                                        <tr>
                                            <td class="sheet-row-header">2</td>
                                            <td class="text-center text-gray-500">1</td>
                                            <td class="font-bold text-red-500 text-center">æœæœƒ</td>
                                            <td class="font-bold text-emerald-600 text-center">æ‹›æœƒ</td>
                                        </tr>
                                        <tr>
                                            <td class="sheet-row-header">3</td>
                                            <td class="text-center text-gray-500">2</td>
                                            <td class="font-bold text-red-500 text-center">é‡ä¿®</td>
                                            <td class="font-bold text-emerald-600 text-center">èŸ²ä¿®</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <p class="text-xs text-gray-500">â€» è‹¥ AI å”¸éŒ¯ç ´éŸ³å­—ï¼Œè«‹æ–¼ C æ¬„å¡«å¯«è«§éŸ³ä¿®æ­£ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Input Form Card -->
            <div class="glass-card rounded-2xl p-6 md:p-8 shadow-xl">
                <div class="space-y-6">
                    
                    <!-- Sheet Input -->
                    <div class="input-group">
                        <label class="block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2 transition-colors">
                            <span class="bg-emerald-100 text-emerald-600 p-1 rounded">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                            </span>
                            Google è©¦ç®—è¡¨é€£çµ (é¸å¡«)
                        </label>
                        <div class="relative">
                            <input type="text" id="sheetUrl" 
                                placeholder="https://docs.google.com/spreadsheets/d/..." 
                                class="w-full pl-4 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition shadow-sm text-sm">
                        </div>
                    </div>

                    <!-- PDF Input -->
                    <div class="input-group">
                        <label class="block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2 transition-colors">
                            <span class="bg-red-100 text-red-600 p-1 rounded">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 2H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>
                            </span>
                            å ±è®€ç”¨ PDF æª”æ¡ˆé€£çµ (å¿…å¡«)
                        </label>
                        <div class="relative">
                            <input type="text" id="pdfUrl" 
                                placeholder="https://drive.google.com/file/d/..." 
                                class="w-full pl-4 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition shadow-sm text-sm">
                        </div>
                    </div>

                    <button onclick="generateAll()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-4 rounded-xl transition transform active:scale-[0.98] shadow-lg flex items-center justify-center gap-2 text-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
                        </svg>
                        ç”Ÿæˆç¶²å€èˆ‡ QR Code
                    </button>
                </div>
            </div>

            <!-- Result Card -->
            <div id="resultCard" class="hidden glass-card rounded-2xl p-8 shadow-2xl border-t-4 border-indigo-500 fade-in">
                <div class="flex flex-col items-center">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                        <span class="text-green-500">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        </span>
                        ç”ŸæˆæˆåŠŸ
                    </h2>
                    
                    <!-- QR Code Container -->
                    <div class="bg-white p-4 rounded-xl shadow-lg mb-6 border border-gray-100">
                        <div id="qrcode"></div>
                    </div>

                    <!-- URL & Copy -->
                    <div class="w-full bg-gray-50 p-4 rounded-xl border border-gray-200 mb-6">
                        <label class="block text-xs font-bold text-gray-500 mb-2 uppercase tracking-wide">å ±è®€ç³»çµ±å°ˆç”¨ç¶²å€</label>
                        <div class="flex gap-2">
                            <input type="text" id="finalUrl" readonly 
                                class="flex-1 bg-white border border-gray-300 px-3 py-2 rounded-lg text-sm text-indigo-600 font-mono focus:outline-none">
                            <button onclick="copyLink()" id="copyBtn" class="bg-gray-800 hover:bg-black text-white px-4 py-2 rounded-lg text-sm font-bold transition flex items-center whitespace-nowrap">
                                è¤‡è£½é€£çµ
                            </button>
                        </div>
                    </div>

                    <a id="openLink" href="#" target="_blank" class="inline-flex items-center justify-center gap-2 text-white bg-indigo-600 hover:bg-indigo-700 px-8 py-3 rounded-full font-bold shadow-md transition transform hover:-translate-y-0.5">
                        ç›´æ¥é–‹å•Ÿç¶²é  
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                        </svg>
                    </a>
                </div>
            </div>

            <!-- Error Message -->
            <div id="errorMsg" class="hidden p-4 bg-red-50 border-l-4 border-red-500 text-red-700 rounded-r-lg shadow-sm text-center font-medium fade-in"></div>

        </div>
    </div>

    <script>
        function extractId(url) {
            if (!url || url.trim() === "") return null;
            const match = url.match(/[-\w]{25,}/);
            return match ? match[0] : null;
        }

        function generateAll() {
            const sheetUrl = document.getElementById('sheetUrl').value.trim();
            const pdfUrl = document.getElementById('pdfUrl').value.trim();
            const errorMsg = document.getElementById('errorMsg');
            const resultCard = document.getElementById('resultCard');
            const finalUrlInput = document.getElementById('finalUrl');
            const openLink = document.getElementById('openLink');

            errorMsg.classList.add('hidden');
            resultCard.classList.add('hidden'); // Reset result visibility
            
            const sheetId = extractId(sheetUrl);
            const pdfId = extractId(pdfUrl);

            if (!pdfId) {
                showError("è«‹ç¢ºèªè¼¸å…¥çš„å ±è®€ç”¨ PDF æª”æ¡ˆé€£çµåŒ…å«æ­£ç¢ºçš„ Google Drive IDã€‚");
                return;
            }

            let baseUrl = "https://read1122-web.github.io/edgetts/";
            let targetUrl = "";
            
            if (sheetId) {
                targetUrl = `${baseUrl}?googlesheetid=${sheetId}&file=${pdfId}`;
            } else {
                targetUrl = `${baseUrl}?file=${pdfId}`;
            }
            
            // Show Result
            finalUrlInput.value = targetUrl;
            openLink.href = targetUrl;
            
            // Generate QR
            const qrcodeDiv = document.getElementById('qrcode');
            qrcodeDiv.innerHTML = ""; 
            new QRCode(qrcodeDiv, {
                text: targetUrl,
                width: 180,
                height: 180,
                colorDark : "#1f2937",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            });
            
            resultCard.classList.remove('hidden');
            
            // Smooth scroll to result
            setTimeout(() => {
                resultCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        function showError(msg) {
            const errorMsg = document.getElementById('errorMsg');
            errorMsg.textContent = msg;
            errorMsg.classList.remove('hidden');
            errorMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function copyLink() {
            const copyText = document.getElementById("finalUrl");
            copyText.select();
            document.execCommand("copy");
            
            const btn = document.getElementById('copyBtn');
            const originalText = btn.innerHTML;
            
            btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg> å·²è¤‡è£½`;
            btn.classList.replace('bg-gray-800', 'bg-green-600');
            
            setTimeout(() => {
                btn.innerHTML = "è¤‡è£½é€£çµ";
                btn.classList.replace('bg-green-600', 'bg-gray-800');
            }, 2000);
        }
    </script>
</body>
</html>
